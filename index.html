<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Random Password Generator</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style id="app-style">
    :root {
      --primary-color: #0de7ff;
      --secondary-color: #ff00dd;
      --bg-color: #0f1219;
      --panel-color: #1a1f2d;
      --text-color: #e6e6e6;
    }
    
    body {
      background-color: var(--bg-color);
      color: var(--text-color);
      font-family: 'Inter', 'Segoe UI', system-ui, -apple-system, sans-serif;
      transition: all 0.3s ease;
    }
    
    .cyberpunk-panel {
      background-color: var(--panel-color);
      border: 1px solid rgba(13, 231, 255, 0.2);
      border-radius: 0.5rem;
      box-shadow: 0 0 15px rgba(13, 231, 255, 0.15);
    }
    
    .neon-text {
      text-shadow: 0 0 5px var(--primary-color);
    }
    
    .password-field {
      background-color: rgba(26, 31, 45, 0.8);
      border: 1px solid rgba(13, 231, 255, 0.3);
      color: var(--primary-color);
      letter-spacing: 1px;
      font-family: 'Courier New', monospace;
    }
    
    .generate-btn {
      background: linear-gradient(90deg, var(--primary-color) 0%, var(--secondary-color) 100%);
      color: #000;
      font-weight: bold;
      text-transform: uppercase;
      transition: all 0.3s ease;
      border: none;
      position: relative;
      overflow: hidden;
    }
    
    .generate-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(13, 231, 255, 0.4);
    }
    
    .generate-btn::before {
      content: "";
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: all 0.6s;
    }
    
    .generate-btn:hover::before {
      left: 100%;
    }
    
    .copy-btn {
      background-color: transparent;
      border: 1px solid var(--primary-color);
      color: var(--primary-color);
      transition: all 0.3s ease;
    }
    
    .copy-btn:hover {
      background-color: var(--primary-color);
      color: var(--bg-color);
    }
    
    .toast {
      background-color: var(--panel-color);
      border-left: 4px solid var(--primary-color);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
    }
    
    /* Custom slider styling */
    input[type="range"] {
      -webkit-appearance: none;
      appearance: none;
      background: linear-gradient(90deg, var(--primary-color) 0%, var(--secondary-color) 100%);
      height: 6px;
      border-radius: 5px;
      outline: none;
    }
    
    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: var(--text-color);
      border: 2px solid var(--primary-color);
      cursor: pointer;
      box-shadow: 0 0 5px rgba(13, 231, 255, 0.5);
    }
    
    /* Custom checkbox styling */
    .custom-checkbox {
      display: flex;
      align-items: center;
      cursor: pointer;
      user-select: none;
      padding: 5px 0;
    }
    
    .custom-checkbox input {
      position: absolute;
      opacity: 0;
      height: 0;
      width: 0;
    }
    
    .checkmark {
      height: 22px;
      width: 22px;
      background-color: transparent;
      border: 2px solid var(--primary-color);
      border-radius: 4px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-right: 10px;
      transition: all 0.2s ease;
    }
    
    .custom-checkbox input:checked ~ .checkmark {
      background-color: var(--primary-color);
    }
    
    .checkmark:after {
      content: "";
      position: relative;
      display: none;
      width: 6px;
      height: 12px;
      border: solid #000;
      border-width: 0 2px 2px 0;
      transform: rotate(45deg);
    }
    
    .custom-checkbox input:checked ~ .checkmark:after {
      display: block;
    }
    
    /* Responsive adjustments */
    @media (max-width: 640px) {
      .main-container {
        padding: 1rem;
      }
    }
    
    /* Animation for spinner */
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    .spinner {
      animation: spin 1s linear infinite;
      display: none;
    }
  </style>
</head>
<body class="min-h-screen flex flex-col items-center p-4 md:p-8">
  <div class="main-container w-full max-w-md mx-auto">
    <h1 class="text-3xl md:text-4xl font-bold text-center mb-8 neon-text">
      Random Password Generator
    </h1>
    
    <div class="cyberpunk-panel p-6 mb-6">
      <div class="mb-6">
        <div class="flex justify-between items-center mb-2">
          <label for="password-length" class="font-medium">Password Length:</label>
          <span id="length-display" class="text-primary-color font-mono">14</span>
        </div>
        <input 
          type="range" 
          id="password-length" 
          name="password-length" 
          min="12" 
          max="16" 
          value="14" 
          class="w-full"
        >
      </div>
      
      <div class="space-y-3">
        <label class="block text-lg mb-2 font-medium">Include:</label>
        
        <label class="custom-checkbox">
          <input type="checkbox" id="uppercase" checked>
          <span class="checkmark"></span>
          Uppercase Letters
        </label>
        
        <label class="custom-checkbox">
          <input type="checkbox" id="lowercase" checked>
          <span class="checkmark"></span>
          Lowercase Letters
        </label>
        
        <label class="custom-checkbox">
          <input type="checkbox" id="numbers" checked>
          <span class="checkmark"></span>
          Numbers
        </label>
        
        <label class="custom-checkbox">
          <input type="checkbox" id="symbols">
          <span class="checkmark"></span>
          Symbols
        </label>
        
        <label class="custom-checkbox">
          <input type="checkbox" id="exclude-ambiguous">
          <span class="checkmark"></span>
          Exclude Ambiguous Characters
        </label>
      </div>
    </div>
    
    <button id="generate-btn" class="generate-btn w-full py-4 rounded-md mb-6 text-lg font-bold flex justify-center items-center">
      <i class="fas fa-sync-alt spinner mr-2"></i>
      Generate Password
    </button>
    
    <div id="password-container" class="relative mb-6 hidden">
      <input 
        type="text" 
        id="password-output" 
        class="password-field w-full py-3 px-4 rounded-md text-lg pr-16" 
        readonly
      >
      <button 
        id="copy-btn" 
        class="copy-btn absolute right-2 top-1/2 transform -translate-y-1/2 h-10 w-10 rounded-md flex items-center justify-center"
      >
        <i class="far fa-copy"></i>
      </button>
    </div>
  </div>
  
  <div id="toast" class="toast fixed bottom-4 right-4 p-4 rounded-md opacity-0 transition-opacity duration-300 transform translate-y-2 hidden">
    Password copied!
  </div>

  <script id="app-script">
    document.addEventListener('DOMContentLoaded', function() {
      // Elements
      const lengthSlider = document.getElementById('password-length');
      const lengthDisplay = document.getElementById('length-display');
      const uppercaseCheck = document.getElementById('uppercase');
      const lowercaseCheck = document.getElementById('lowercase');
      const numbersCheck = document.getElementById('numbers');
      const symbolsCheck = document.getElementById('symbols');
      const excludeAmbiguousCheck = document.getElementById('exclude-ambiguous');
      const generateBtn = document.getElementById('generate-btn');
      const passwordOutput = document.getElementById('password-output');
      const passwordContainer = document.getElementById('password-container');
      const copyBtn = document.getElementById('copy-btn');
      const spinner = document.querySelector('.spinner');
      const toast = document.getElementById('toast');
      
      // Load saved settings from localStorage
      function loadSavedSettings() {
        const savedSettings = JSON.parse(localStorage.getItem('passwordGeneratorSettings'));
        
        if (savedSettings) {
          lengthSlider.value = savedSettings.length;
          lengthDisplay.textContent = savedSettings.length;
          uppercaseCheck.checked = savedSettings.uppercase;
          lowercaseCheck.checked = savedSettings.lowercase;
          numbersCheck.checked = savedSettings.numbers;
          symbolsCheck.checked = savedSettings.symbols;
          excludeAmbiguousCheck.checked = savedSettings.excludeAmbiguous;
        }
      }
      
      // Save current settings to localStorage
      function saveSettings() {
        const settings = {
          length: lengthSlider.value,
          uppercase: uppercaseCheck.checked,
          lowercase: lowercaseCheck.checked,
          numbers: numbersCheck.checked,
          symbols: symbolsCheck.checked,
          excludeAmbiguous: excludeAmbiguousCheck.checked
        };
        
        localStorage.setItem('passwordGeneratorSettings', JSON.stringify(settings));
      }
      
      // Update length display when slider changes
      lengthSlider.addEventListener('input', function() {
        lengthDisplay.textContent = this.value;
        saveSettings();
      });
      
      // Save settings when checkboxes change
      [uppercaseCheck, lowercaseCheck, numbersCheck, symbolsCheck, excludeAmbiguousCheck].forEach(checkbox => {
        checkbox.addEventListener('change', saveSettings);
      });
      
      // Generate password when button is clicked
      generateBtn.addEventListener('click', async function() {
        // Validate character-type selection
        if (!uppercaseCheck.checked && !lowercaseCheck.checked &&
            !numbersCheck.checked && !symbolsCheck.checked) {
          alert('Please select at least one character type');
          return;
        }

        // Show spinner, hide existing password
        spinner.style.display = 'inline-block';
        passwordContainer.classList.add('hidden');

        // Save current settings
        saveSettings();

        try {
          const payload = {
            length: parseInt(lengthSlider.value),
            useUppercase: uppercaseCheck.checked,
            useLowercase: lowercaseCheck.checked,
            useNumbers: numbersCheck.checked,
            useSymbols: symbolsCheck.checked,
            excludeAmbiguous: excludeAmbiguousCheck.checked
          };

          const response = await fetch(
            'https://magicloops.dev/api/loop/8c25eb1a-3c64-46d7-b425-4557b8213467/run',
            {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify(payload)
            }
          );

          const data = await response.json();
          // Hide spinner
          spinner.style.display = 'none';

          // Assuming the loop returns { password: 'â€¦' }
          passwordOutput.value = data.password || '';
          passwordContainer.classList.remove('hidden');
        } catch (err) {
          spinner.style.display = 'none';
          alert('Error generating password. Please try again.');
          console.error(err);
        }
      });
      
      // Copy password to clipboard
      copyBtn.addEventListener('click', function() {
        passwordOutput.select();
        document.execCommand('copy');
        
        // Show toast notification
        toast.classList.remove('hidden', 'opacity-0');
        toast.classList.add('opacity-100');
        
        // Hide toast after 3 seconds
        setTimeout(() => {
          toast.classList.remove('opacity-100');
          toast.classList.add('opacity-0');
          
          setTimeout(() => {
            toast.classList.add('hidden');
          }, 300);
        }, 3000);
      });
    });
  </script>
</body>
</html>